# ----------------------------------------------------------------------------
# Database PostgreSQL
# ----------------------------------------------------------------------------
DB_USER=qadhya
DB_PASSWORD=dev_password_change_in_production
DATABASE_URL=postgresql://qadhya:dev_password_change_in_production@localhost:5433/qadhya

# ----------------------------------------------------------------------------
# MinIO Storage
# ----------------------------------------------------------------------------
MINIO_ROOT_USER=minioadmin
MINIO_ROOT_PASSWORD=minioadmin123
MINIO_ENDPOINT=localhost
MINIO_PORT=9000
MINIO_USE_SSL=false
MINIO_ACCESS_KEY=minioadmin
MINIO_SECRET_KEY=minioadmin123
MINIO_BUCKET=documents

# ----------------------------------------------------------------------------
# Redis Cache
# ----------------------------------------------------------------------------
REDIS_URL=redis://localhost:6379

# ----------------------------------------------------------------------------
# Resend (Email Service - WhatsApp notifications)
RESEND_API_KEY=re_your_api_key
RESEND_FROM_EMAIL=notifications@qadhya.tn

# Brevo (Email Service - Notifications quotidiennes)
# Obtenir une clé: https://app.brevo.com/settings/keys/api
BREVO_API_KEY=xkeysib-...
BREVO_SENDER_EMAIL=notifications@qadhya.tn
BREVO_SENDER_NAME=Qadhya

# Cron Jobs (Notifications quotidiennes)
# Générer avec: openssl rand -hex 32
# Utilisé pour sécuriser l'endpoint /api/cron/daily-digest
CRON_SECRET=your-random-cron-secret-min-32-chars

# Google Drive OAuth (Cloud Storage)
GOOGLE_CLIENT_ID=your-google-client-id.apps.googleusercontent.com
GOOGLE_CLIENT_SECRET=your-google-client-secret
GOOGLE_REDIRECT_URI=http://localhost:7002/api/integrations/google-drive/callback
GOOGLE_DRIVE_WEBHOOK_VERIFY_TOKEN=your-random-verify-token-min-32-chars

# WhatsApp Business API (Messaging)
WHATSAPP_WEBHOOK_VERIFY_TOKEN=your-random-verify-token-min-20-chars
WHATSAPP_APP_SECRET=your-meta-app-secret

# Application
NEXT_PUBLIC_APP_URL=http://localhost:7002
NEXT_PUBLIC_APP_NAME=Qadhya
NEXT_PUBLIC_APP_DOMAIN=qadhya.tn

# Security - Encryption Key pour chiffrer tokens Google Drive
# Générer avec: openssl rand -hex 32
# IMPORTANT: Ne JAMAIS commit cette clé dans Git!
ENCRYPTION_KEY=your-64-char-hex-key-generated-with-openssl-rand-hex-32-here

# Environment
NODE_ENV=development

# =============================================================================
# IA / RAG Configuration
# =============================================================================

# Anthropic Claude (LLM principal pour chat et génération)
# Obtenir une clé: https://console.anthropic.com/
ANTHROPIC_API_KEY=sk-ant-api03-...
ANTHROPIC_MODEL=claude-sonnet-4-20250514

# Groq (LLM rapide et économique - prioritaire si configuré)
# Obtenir une clé: https://console.groq.com/keys
GROQ_API_KEY=gsk_...
GROQ_MODEL=llama-3.3-70b-versatile

# OpenAI (Embeddings cloud - utilisé si Ollama non disponible)
# Obtenir une clé: https://platform.openai.com/api-keys
OPENAI_API_KEY=sk-proj-...
OPENAI_EMBEDDING_MODEL=text-embedding-3-small

# Ollama Embeddings (RECOMMANDÉ - gratuit, local, illimité)
# Installation: brew install ollama && ollama serve
# Télécharger modèle: ollama pull qwen3-embedding:0.6b
# Alternative légère: ollama pull granite-embedding
OLLAMA_ENABLED=true
OLLAMA_BASE_URL=http://localhost:11434
OLLAMA_EMBEDDING_MODEL=qwen3-embedding:0.6b

# RAG Configuration
RAG_ENABLED=false
RAG_CHUNK_SIZE=1024
RAG_CHUNK_OVERLAP=100
RAG_MAX_RESULTS=5
RAG_SIMILARITY_THRESHOLD=0.7

# RAG Seuils par type de source (optionnel)
RAG_THRESHOLD_DOCUMENTS=0.7
RAG_THRESHOLD_JURISPRUDENCE=0.6
RAG_THRESHOLD_KB=0.65
RAG_THRESHOLD_MIN=0.5

# RAG Diversité des sources (optionnel)
RAG_MAX_CHUNKS_PER_SOURCE=2
RAG_MIN_SOURCES=2

# RAG Limite contexte (tokens max pour le contexte)
RAG_MAX_CONTEXT_TOKENS=2000

# =============================================================================
# Cache Redis (Semantic Cache)
# =============================================================================

# TTL Cache embeddings (secondes) - défaut: 7 jours
EMBEDDING_CACHE_TTL=604800

# TTL Cache recherche (secondes) - défaut: 1 heure
SEARCH_CACHE_TTL=3600

# Seuil similarité pour cache hit - défaut: 0.95
SEARCH_CACHE_THRESHOLD=0.95

# =============================================================================
# Query Expansion (Recherche bilingue AR↔FR)
# =============================================================================

# Activer la recherche bilingue (true/false)
ENABLE_QUERY_EXPANSION=true

# Modèle de traduction (Groq)
TRANSLATION_MODEL=llama-3.1-8b-instant

# =============================================================================
# Indexation Async
# =============================================================================

# Nombre de jobs à traiter par batch
INDEXING_BATCH_SIZE=5

# Nombre max de tentatives par job
INDEXING_MAX_ATTEMPTS=3

# Quotas IA (par utilisateur)
AI_MONTHLY_QUOTA_DEFAULT=100
AI_MAX_TOKENS_PER_REQUEST=4000

# =============================================================================
# Backups Configuration
# =============================================================================

# Répertoire des backups (doit exister et avoir les permissions)
BACKUP_DIR=/opt/backups/qadhya

# Script de backup (chemin absolu)
BACKUP_SCRIPT=/opt/qadhya/backup.sh

# Email admin pour alertes backup (utilise Brevo)
ADMIN_EMAIL=admin@qadhya.tn
